<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C2A Student Report | DDx Engine</title>
    <style>
        :root {
            /* ============================================================== */
            /* üé® BRAND COLORS: Sunwashed Palette                             */
            /* ============================================================== */
            --primary: #1297D2;         /* Navy Blue (Main brand color) */
            --primary-hover: #0e7cae;   /* Slightly darker for hover states */
            --primary-light: #eef8fb;   /* Very light tint for backgrounds */
            --primary-border: #96D7E1;  /* Sky Blue (Medium tint for borders) */
            --primary-dark: #0a5678;    /* Dark shade for text on light backgrounds */
            
            /* ============================================================== */
            /* ‚öôÔ∏è BASE UI COLORS                                              */
            /* ============================================================== */
            --bg-body: #f8fafc;         /* App background */
            --bg-card: #ffffff;         /* Card background */
            --bg-hover: #f1f5f9;        /* Hover background for menus */
            --text-main: #0f172a;       /* Main text (Dark) */
            --text-muted: #64748b;      /* Secondary text (Gray) */
            --border: #e2e8f0;          /* Standard borders */
            --border-hover: #cbd5e1;    /* Hover borders */
            
            /* ============================================================== */
            /* üö¶ 3-TIER SYSTEM COLORS (Blocker / Watch / Clear)              */
            /* ============================================================== */
            --tier-blocker-bg: #fef2f2;
            --tier-blocker-text: #b91c1c;
            --tier-blocker-border: #f87171;
            
            /* Integrated Palette Orange and Yellow for the Watch Tier */
            --tier-watch-bg: #fffce8;    /* Very light yellow tint based on #FDE677 */
            --tier-watch-text: #a65615;  /* Darkened version of Orange for text readability */
            --tier-watch-border: #F89E54;/* Orange from palette */
            
            --tier-clear-bg: #ecfdf5;
            --tier-clear-text: #047857;
            --tier-clear-border: #34d399;

            /* Spacing & Effects */
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        body { background: var(--bg-body); color: var(--text-main); line-height: 1.5; padding-bottom: 4rem; }

        header { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 1.5rem 0; margin-bottom: 2rem; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; }
        .header-top { display: flex; justify-content: space-between; align-items: center; }
        
        .student-switcher { padding: 0.5rem; font-size: 1rem; border-radius: 8px; border: 1px solid var(--border-hover); font-weight: 600; color: var(--primary); background: var(--bg-body); cursor: pointer; outline: none; }
        .student-switcher:focus { border-color: var(--primary); box-shadow: 0 0 0 2px var(--primary-light); }

        /* New Layout Grids */
        .top-dash-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin-bottom: 1.5rem; }
        .main-grid { display: grid; grid-template-columns: 350px 1fr; gap: 1.5rem; align-items: start; }

        /* Top Dash Cards */
        .dash-card { background: var(--bg-card); border-radius: var(--radius); padding: 1.5rem; box-shadow: var(--shadow); border: 1px solid var(--border); transition: background-color 0.3s ease; }
        .dash-card.pulse-blocker, .accordion-item.pulse-blocker { animation: pulseRed 1s ease; }
        .dash-title { font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); font-weight: 700; margin-bottom: 0.75rem; display: flex; justify-content: space-between; align-items: center; }
        
        .metric-row { display: flex; gap: 1rem; margin-top: 1rem; }
        .metric-box { background: var(--bg-body); padding: 0.75rem; border-radius: 8px; flex: 1; text-align: center; border: 1px solid var(--border); display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 0.5rem; }
        .metric-box strong { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

        /* Accordions */
        .accordion-item { margin-bottom: 1rem; background: var(--bg-card); border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow); }
        .accordion-header { cursor: pointer; display: flex; justify-content: space-between; align-items: center; padding: 1.25rem; font-weight: 700; transition: background 0.2s; border-radius: var(--radius); }
        .accordion-header:hover { background: var(--bg-hover); }
        .accordion-header.active { border-radius: var(--radius) var(--radius) 0 0; border-bottom: 1px solid var(--border); }
        .accordion-content { display: none; padding: 1.25rem; }
        .accordion-content.active { display: block; }
        .acc-title-group { display: flex; align-items: center; gap: 0.75rem; }

        /* Caret Icons */
        .acc-right { display: flex; align-items: center; gap: 0.75rem; }
        .caret-icon { width: 1.25rem; height: 1.25rem; color: var(--text-muted); transition: transform 0.2s ease; }
        .accordion-header.active .caret-icon { transform: rotate(180deg); }

        /* Badges */
        .badge { font-size: 0.75rem; font-weight: 700; padding: 4px 8px; border-radius: 6px; border: 1px solid; display: inline-block; text-align: center;}
        .badge.blocker { background: var(--tier-blocker-bg); color: var(--tier-blocker-text); border-color: var(--tier-blocker-border); }
        .badge.watch { background: var(--tier-watch-bg); color: var(--tier-watch-text); border-color: var(--tier-watch-border); }
        .badge.clear { background: var(--tier-clear-bg); color: var(--tier-clear-text); border-color: var(--tier-clear-border); }
        
        /* Summary Pills for Top Dash */
        .summary-pills { display: flex; gap: 0.5rem; align-items: center; }
        .summary-pill {
            display: flex; align-items: center; padding: 3px 10px 3px 4px;
            border-radius: 20px; font-size: 0.7rem; font-weight: 800;
            text-transform: uppercase; border: 1px solid;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05); letter-spacing: 0.5px;
        }
        .summary-pill .count {
            background: var(--bg-card); border-radius: 50%; width: 20px; height: 20px;
            display: flex; justify-content: center; align-items: center;
            font-size: 0.75rem; margin-right: 6px; box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .summary-pill.blocker { background: var(--tier-blocker-bg); color: var(--tier-blocker-text); border-color: var(--tier-blocker-border); }
        .summary-pill.watch { background: var(--tier-watch-bg); color: var(--tier-watch-text); border-color: var(--tier-watch-border); }
        .summary-pill.clear { background: var(--tier-clear-bg); color: var(--tier-clear-text); border-color: var(--tier-clear-border); padding: 4px 12px; }
        .summary-pill.clear .count { display: none; }

        /* Skills List */
        .skills-list { display: flex; flex-direction: column; gap: 0.5rem; }
        .skill-row {
            background: var(--bg-body); border: 1px solid var(--border); border-radius: 8px; padding: 1rem 1.25rem;
            cursor: pointer; transition: all 0.2s ease; display: flex; justify-content: space-between; align-items: center;
        }
        .skill-row:hover { transform: translateX(4px); border-color: var(--primary-border); background: var(--bg-card); box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .skill-row.selected { border: 2px solid var(--primary); background-color: var(--primary-light); }
        .skill-row .skill-name { font-weight: 700; font-size: 1rem; color: var(--text-main); margin: 0; }
        
        /* Action Planner (Right Col) */
        .planner-section { background: var(--bg-card); border-radius: var(--radius); padding: 1.5rem; border: 1px solid var(--border); box-shadow: var(--shadow); position: sticky; top: 20px; min-height: 400px; }
        .planner-empty { text-align: center; padding: 3rem 1.5rem; color: var(--text-muted); border: 2px dashed var(--border); border-radius: 12px; background: var(--bg-body); margin-top: 1rem; height: 100%; display: flex; align-items: center; justify-content: center; }

        .ddx-output { display: none; animation: fadeIn 0.3s ease; }
        .ddx-header { margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border); }
        .ddx-header h2 { font-size: 1.4rem; color: var(--text-main); margin-bottom: 0.25rem; }
        .ef-lens { font-size: 0.85rem; color: var(--text-muted); font-weight: 600; font-family: monospace; }
        
        /* Inner Planner Grid */
        .planner-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; margin-bottom: 1.25rem; }
        .ui-section { display: flex; flex-direction: column; }
        .ui-label { font-size: 0.75rem; text-transform: uppercase; font-weight: 800; color: var(--text-muted); letter-spacing: 0.5px; margin-bottom: 0.5rem; display: block; }
        
        /* Boxes - Made to stretch equally in grid */
        .content-box { height: 100%; box-sizing: border-box; }
        .student-ui-box { background: #f0fdf4; border-left: 4px solid #22c55e; padding: 1.25rem; border-radius: 0 8px 8px 0; color: #166534; font-size: 0.95rem; line-height: 1.5; font-weight: 500; }
        
        /* Recs list */
        .rec-item { background: var(--bg-card); border: 1px solid var(--border); padding: 1rem; border-radius: 8px; margin-bottom: 0.75rem; font-size: 0.9rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .rec-tag { font-size: 0.7rem; font-weight: 800; background: var(--border); color: var(--text-muted); padding: 2px 6px; border-radius: 4px; display: inline-block; margin-bottom: 0.5rem; }
        .rec-title { font-weight: 700; color: var(--text-main); margin-bottom: 0.25rem; display: block; }
        .rec-source { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem; font-style: italic; display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 1024px) {
            .top-dash-grid { grid-template-columns: 1fr; }
            .main-grid { grid-template-columns: 1fr; }
            .planner-grid-2 { grid-template-columns: 1fr; }
            .planner-section { position: static; }
        }
    </style>
</head>
<body>

<header>
    <div class="container header-top">
        <div>
            <h1 style="font-size:1.5rem; font-weight:800; color:var(--text-main); display: flex; align-items: center; gap: 1rem;">
                Viewing Profile:
                <select id="student-selector" class="student-switcher" onchange="switchStudent(this.value)">
                    <option value="carlos" selected>Carlos (Mixed Strengths & Needs Focus)</option>
                </select>
            </h1>
            <p style="color:var(--text-muted); font-size:0.9rem; margin-top:0.25rem;">Diagnostic Analysis (DDx Schema Active)</p>
        </div>
        
        <!-- Click to Expand Hint Box (Using Brand Colors) -->
        <div style="background: var(--primary-light); border: 1px dashed var(--primary-border); color: var(--primary-dark); padding: 0.75rem 1.25rem; border-radius: 8px; font-size: 0.85rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
            <svg style="width: 18px; height: 18px; color: var(--primary);" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
            </svg>
            Click any section below to expand
        </div>
    </div>
</header>

<!-- Top Dash Grid for Engine & Fuel -->
<div class="container top-dash-grid">
    <div id="card-engine" class="accordion-item" style="margin-bottom: 0;">
        <div class="accordion-header" onclick="toggleAcc(this)">
            <div class="acc-title-group">
                <span>üß† My Engine (Executive Function)</span>
            </div>
            <div class="acc-right">
                <div id="summary-ef" class="summary-pills"></div>
                <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </div>
        </div>
        <div class="accordion-content">
            <p id="text-ef-desc" style="font-size:0.85rem; color:var(--text-muted); margin-bottom:0;"></p>
            <div class="metric-row">
                <div class="metric-box">
                    <strong>Working Memory</strong>
                    <span id="badge-ef-wm" class="badge"></span>
                </div>
                <div class="metric-box">
                    <strong>Inhibition</strong>
                    <span id="badge-ef-inh" class="badge"></span>
                </div>
                <div class="metric-box">
                    <strong>Cognitive Flex</strong>
                    <span id="badge-ef-cf" class="badge"></span>
                </div>
            </div>
        </div>
    </div>

    <div id="card-fuel" class="accordion-item" style="margin-bottom: 0;">
        <div class="accordion-header" onclick="toggleAcc(this)">
            <div class="acc-title-group">
                <span>üî• My Fuel (Motivation & Needs)</span>
            </div>
            <div class="acc-right">
                <div id="summary-fuel" class="summary-pills"></div>
                <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </div>
        </div>
        <div class="accordion-content">
            <p id="text-fuel-desc" style="font-size:0.85rem; color:var(--text-muted); margin-bottom:0;"></p>
            <div class="metric-row">
                <div class="metric-box">
                    <strong>Autonomy</strong>
                    <span id="badge-fuel-aut" class="badge"></span>
                </div>
                <div class="metric-box">
                    <strong>Competence</strong>
                    <span id="badge-fuel-comp" class="badge"></span>
                </div>
                <div class="metric-box">
                    <strong>Relatedness</strong>
                    <span id="badge-fuel-rel" class="badge"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 2-Column Main Grid -->
<div class="container main-grid">

    <!-- LEFT COL: 4 Pillars (Accordions) -->
    <aside class="pillars-col">
        <p style="color:var(--text-muted); margin-bottom:1rem; font-weight:600; font-size:0.9rem;">Select a durable skill to build a plan.</p>

        <!-- Pillar 1 -->
        <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <div class="acc-title-group">üí° Creative & Curious</div>
                <div class="acc-right">
                    <span class="badge watch">1 Needs Focus</span>
                    <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
            <div class="accordion-content">
                <div class="skills-list">
                    <div id="card-crit" class="skill-row" onclick="selectSkill('crit', this)">
                        <div class="skill-name">Critical Thinking</div>
                        <span id="badge-skill-crit" class="badge"></span>
                    </div>
                    <div id="card-cps" class="skill-row" onclick="selectSkill('cps', this)">
                        <div class="skill-name">Creative Problem Solving</div>
                        <span id="badge-skill-cps" class="badge"></span>
                    </div>
                    <div id="card-curio" class="skill-row" onclick="selectSkill('curio', this)">
                        <div class="skill-name">Curiosity</div>
                        <span id="badge-skill-curio" class="badge"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pillar 2 -->
        <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <div class="acc-title-group">üöÄ Purpose & Agency</div>
                <div class="acc-right">
                    <span class="badge blocker">1 Blocker</span>
                    <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
            <div class="accordion-content">
                <div class="skills-list">
                    <div id="card-init" class="skill-row" onclick="selectSkill('init', this)">
                        <div class="skill-name">Initiative</div>
                        <span id="badge-skill-init" class="badge"></span>
                    </div>
                    <div id="card-resil" class="skill-row" onclick="selectSkill('resil', this)">
                        <div class="skill-name">Resilience</div>
                        <span id="badge-skill-resil" class="badge"></span>
                    </div>
                    <div id="card-comm" class="skill-row" onclick="selectSkill('comm', this)">
                        <div class="skill-name">Communication</div>
                        <span id="badge-skill-comm" class="badge"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pillar 3 -->
        <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <div class="acc-title-group">üåä Thrivers in Change</div>
                <div class="acc-right">
                    <span class="badge watch">1 Needs Focus</span>
                    <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
            <div class="accordion-content">
                <div class="skills-list">
                    <div id="card-adapt" class="skill-row" onclick="selectSkill('adapt', this)">
                        <div class="skill-name">Adaptability</div>
                        <span id="badge-skill-adapt" class="badge"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pillar 4 -->
        <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <div class="acc-title-group">ü§ù Network Builders</div>
                <div class="acc-right">
                    <span class="badge clear">All Clear</span>
                    <svg class="caret-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
            <div class="accordion-content">
                <div class="skills-list">
                    <div id="card-collab" class="skill-row" onclick="selectSkill('collab', this)">
                        <div class="skill-name">Collaboration</div>
                        <span id="badge-skill-collab" class="badge"></span>
                    </div>
                    <div id="card-net" class="skill-row" onclick="selectSkill('net', this)">
                        <div class="skill-name">Networking</div>
                        <span id="badge-skill-net" class="badge"></span>
                    </div>
                    <div id="card-rel" class="skill-row" onclick="selectSkill('rel', this)">
                        <div class="skill-name">Relationship Building</div>
                        <span id="badge-skill-rel" class="badge"></span>
                    </div>
                    <div id="card-emp" class="skill-row" onclick="selectSkill('emp', this)">
                        <div class="skill-name">Empathy</div>
                        <span id="badge-skill-emp" class="badge"></span>
                    </div>
                    <div id="card-soc" class="skill-row" onclick="selectSkill('soc', this)">
                        <div class="skill-name">Social Awareness</div>
                        <span id="badge-skill-soc" class="badge"></span>
                    </div>
                </div>
            </div>
        </div>

    </aside>

    <!-- RIGHT COL: DDx Action Planner Schema -->
    <main class="planner-col">
        <div class="planner-section">
            <div id="empty-state" class="planner-empty">
                <div>
                    <h3 style="color:var(--text-main); margin-bottom:0.5rem;">No Skill Selected</h3>
                    <p>Select a durable skill from the left panel to view the tailored coaching and student feedback plan.</p>
                </div>
            </div>

            <div id="ddx-output" class="ddx-output">
                <div class="ddx-header">
                    <h2 id="ddx-skill-title">Skill Name</h2>
                    <span id="ddx-status-badge" class="badge">Status</span>
                    <div id="ddx-ef-lens" class="ef-lens" style="margin-top:0.5rem;"></div>
                </div>

                <!-- Strengths-First Student UI -->
                <div class="ui-section" style="margin-bottom: 1.5rem;">
                    <span class="ui-label">Your Approach (Strengths First)</span>
                    <div id="ddx-student-ui" class="content-box student-ui-box"></div>
                </div>

                <!-- Recommendations (Full Width) -->
                <div class="ui-section" style="margin-bottom: 0;">
                    <span class="ui-label" style="color: var(--primary); display: flex; align-items: center; gap: 0.35rem;">
                        <svg style="width: 14px; height: 14px;" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                        Coach's Toolkit (How they will support you)
                    </span>
                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.75rem;">Your tutor will bring these specific, evidence-based activities to your sessions to help you build this skill.</p>
                    <div id="ddx-recs-container"></div>
                </div>
                
                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-top: 1.5rem; font-style: italic; border-top: 1px solid var(--border); padding-top: 1rem;">
                    Micro-caveat: These are coaching signals; supports help strengths show up consistently (not a diagnosis).
                </p>

            </div>
        </div>
    </main>

</div>

<script>
    // Accordion Logic
    function toggleAcc(element) {
        element.classList.toggle("active");
        var content = element.nextElementSibling;
        if (content.classList.contains("active")) {
            content.classList.remove("active");
        } else {
            content.classList.add("active");
        }
    }

    // Data Store built from the provided schema and 24 starter entries
    const students = {
        'carlos': {
            engine: { tier: 'EF-2 (Constraints)', cls: 'watch', wm: 'Watch', wmCls: 'watch', inh: 'Blocker', inhCls: 'blocker', cf: 'Clear', cfCls: 'clear', text: 'Working Memory and Inhibition are currently presenting constraints.' },
            fuel: { tier: 'Mixed (Watch)', cls: 'watch', aut: 'Watch', autCls: 'watch', comp: 'Watch', compCls: 'watch', rel: 'Thriving', relCls: 'clear', text: 'You are highly motivated to connect, but competence/autonomy need monitoring.' },
            skills: {
                crit: { text: 'Needs Focus', cls: 'watch' }, 
                cps: { text: 'Strong', cls: 'clear' },
                curio: { text: 'Strong', cls: 'clear' },
                init: { text: 'Blocker', cls: 'blocker' }, 
                resil: { text: 'Needs Focus', cls: 'watch' },
                comm: { text: 'Needs Focus', cls: 'watch' },
                adapt: { text: 'Needs Focus', cls: 'watch' },
                collab: { text: 'Strong', cls: 'clear' },
                net: { text: 'Strong', cls: 'clear' },
                rel: { text: 'Strong', cls: 'clear' },
                emp: { text: 'Strong', cls: 'clear' },
                soc: { text: 'Needs Focus', cls: 'watch' }
            },
            ddx: {
                crit: {
                    name: 'Critical Thinking', statusClass: 'watch', statusText: 'Needs Focus', efLens: 'cognitive_wm ‚Äî Cognitive | Working Memory (WM)',
                    studentUi: 'You may do your best work when you can focus on one clear thread. When the task asks you to hold several ideas, steps, or sources in mind at once, your strengths can show up more consistently with simple structure and external supports.',
                    recs: [
                        { tag: 'EF-WM', title: 'Fact‚ÄìAssumption‚ÄìQuestion (FAQ) Split (Moderate)', desc: 'Write the decision/claim in one sentence.', source: 'Kahneman, D. (2011). Thinking, Fast and Slow.' },
                        { tag: 'EF-WM/ARC-Competence', title: 'Claim‚ÄìEvidence‚ÄìReasoning (CER) for Work Decisions', desc: 'Write your claim: what you recommend.', source: 'Toulmin, S. (1958). The Uses of Argument.' }
                    ]
                },
                cps: {
                    name: 'Creative Problem Solving', statusClass: 'clear', statusText: 'Strong', efLens: 'cognitive_inh ‚Äî Cognitive | Inhibition',
                    studentUi: 'You may be quick to spot a direction and move‚Äîoften a real strength. This skill gets easier when you add a short pause that helps you choose intentionally rather than defaulting to the first answer.',
                    recs: [
                        { tag: 'EF-Inh/ARC-Regulation', title: 'Constraint Flip: "How Might We‚Ä¶ with Limits?"', desc: 'List your top 2 constraints (time, budget, staff).', source: 'Stokes, P. D. (2005). Creativity from constraints.' },
                        { tag: 'EF-Inh', title: '5 Whys + One Proof Check (Practice-based)', desc: 'Write the problem as an observable event.', source: 'Imai, M. (2012). Gemba Kaizen (2nd ed.).' }
                    ]
                },
                curio: {
                    name: 'Curiosity', statusClass: 'clear', statusText: 'Strong', efLens: 'cognitive_cogflex ‚Äî Cognitive | Cognitive Flexibility',
                    studentUi: 'You have a natural ability to seek out new information. When faced with a rigid framework, practicing small perspective-shifts can help keep your curiosity engaged.',
                    recs: [
                        { tag: 'EF-CogFlex', title: 'Argue the Opposite Position', desc: 'Take 5 minutes to write down three reasons the opposing view makes sense.', source: 'Stanovich, K. E. (2000).' }
                    ]
                },
                init: {
                     name: 'Initiative', statusClass: 'blocker', statusText: 'Blocker', efLens: 'self_directed_wm_inh ‚Äî Self-Directed | WM + Inhibition',
                     studentUi: 'You may genuinely want to follow through. When a plan has multiple steps and distractions or frustration show up, it can help to make the next step visible and protect it with a few guardrails.',
                     recs: [
                         { tag: 'EF-WM+Inh', title: 'If-Then Planning (Implementation Intentions)', desc: 'Choose one task and decide exactly when and where you will start it.', source: 'Gollwitzer & Sheeran (2006) Meta-Analysis' },
                         { tag: 'ARC-Connection/EF-Inh', title: 'Accountability Check-ins (Moderate)', desc: 'Identify an accountability partner (a friend, coach, or classmate).', source: 'Matthews (2007), Dominican Univ. Study' }
                     ]
                },
                resil: {
                    name: 'Resilience', statusClass: 'watch', statusText: 'Needs Focus', efLens: 'self_directed_wm ‚Äî Self-Directed | Working Memory (WM)',
                    studentUi: 'You have strong goals and intentions. When setbacks happen, keeping your original goal highly visible prevents it from getting lost in the shuffle of frustration.',
                    recs: [
                        { tag: 'EF-WM', title: 'Visible Goal Tracker', desc: 'Keep a sticky note with your primary goal on your workspace.', source: 'Locke & Latham (2002).' }
                    ]
                },
                comm: {
                     name: 'Communication', statusClass: 'watch', statusText: 'Needs Focus', efLens: 'interpersonal_wm ‚Äî Interpersonal | Working Memory (WM)',
                     studentUi: 'You may contribute best when conversations are calmer or more structured. In fast groups, supports that help you track the thread can make it easier to participate in the way you intend.',
                     recs: [
                         { tag: 'EF-WM/ARC-Connection', title: '"I-Statement" Assertion Technique (Moderate)', desc: 'Draft an ‚ÄúI feel‚Ä¶when‚Ä¶because‚Ä¶I need‚Ä¶‚Äù sentence.', source: 'Speed et al. (2017)' },
                         { tag: 'EF-WM', title: 'Role-Play Your Message (Moderate)', desc: 'Choose an upcoming conversation you‚Äôre nervous about and practice out loud.', source: 'Luciano et al. (2020)' }
                     ]
                },
                adapt: {
                    name: 'Adaptability', statusClass: 'watch', statusText: 'Needs Focus', efLens: 'cognitive_inh ‚Äî Cognitive | Inhibition',
                    studentUi: 'You may be quick to spot a direction and move‚Äîoften a real strength. This skill gets easier when you add a short pause that helps you choose intentionally rather than defaulting to the first answer.',
                    recs: [
                        { tag: 'EF-Inh/ARC-Regulation', title: 'Mindful Pause in Uncertainty (Strong)', desc: 'Next time something unexpected happens, take one slow breath and name what‚Äôs happening.', source: 'H√∂lzel et al. (2011)' },
                        { tag: 'EF-Inh', title: 'Reframe Setbacks as Learning', desc: 'When a plan goes wrong, write one ‚Äúwhat this teaches me‚Äù sentence.', source: 'Gross & John (2003)' }
                    ]
                },
                collab: {
                    name: 'Collaboration', statusClass: 'clear', statusText: 'Strong', efLens: 'self_directed_wm_inh ‚Äî Self-Directed | WM + Inhibition',
                    studentUi: 'You may genuinely want to follow through. When a plan has multiple steps and distractions or frustration show up, it can help to make the next step visible and protect it with a few guardrails.',
                    recs: [
                        { tag: 'EF-WM+Inh', title: 'Visible Work Board (3 Columns)', desc: 'Create a simple board: To Do / Doing / Done.', source: 'Kanban method (Anderson, 2010).' },
                        { tag: 'ARC-Connection/EF-Inh', title: '3-Point Agenda + Decision Log', desc: 'Before the meeting, write a 3-point agenda: updates, decisions, blockers.', source: 'Rogelberg, S. G. (2019)' }
                    ]
                },
                net: {
                    name: 'Networking', statusClass: 'clear', statusText: 'Strong', efLens: 'interpersonal_wm ‚Äî Interpersonal | Working Memory (WM)',
                    studentUi: 'You naturally build strong 1:1 connections. In larger networking settings, using a simple conversation framework can help reduce the mental energy needed to track multiple people.',
                    recs: [
                        { tag: 'EF-WM', title: 'Conversation Prep Template', desc: 'Write down 2 key questions before entering a group setting.', source: 'LE3 Interpersonal Framework.' }
                    ]
                },
                rel: {
                    name: 'Relationship Building', statusClass: 'clear', statusText: 'Strong', efLens: 'Asset Leverage',
                    studentUi: 'You naturally form trusting relationships with adults. This is a massive strength! When things get tough, your ability to connect 1-on-1 is the best tool you have to get back on track.',
                    recs: [
                        { tag: 'ARC-Connection', title: 'Leverage 1:1 Check-ins', desc: 'Seek out 1:1 time with a trusted tutor when frustrated.', source: 'Deci & Ryan (2000).' }
                    ]
                },
                emp: {
                    name: 'Empathy', statusClass: 'clear', statusText: 'Strong', efLens: 'Asset Leverage',
                    studentUi: 'Your naturally high capacity for connection allows you to easily shift into others\' perspectives. You can use this superpower to help scaffold weaker skills in group settings.',
                    recs: [
                        { tag: 'ARC-Connection', title: 'Mediate Team Conflict', desc: 'Use empathy to find common ground in group Collaboration tasks.', source: 'LE3 Asset Framework.' }
                    ]
                },
                soc: {
                    name: 'Social Awareness', statusClass: 'watch', statusText: 'Needs Focus', efLens: 'interpersonal_inh ‚Äî Interpersonal | Inhibition',
                    studentUi: 'You care about how others feel, but sometimes quick emotional reactions can make it hard to read the room. A slight pause gives your brain time to process social cues.',
                    recs: [
                        { tag: 'EF-Inh', title: 'Pause-and-Observe Strategy', desc: 'Take a 3-second mental pause before responding in a tense social situation.', source: 'LE3 Social Framework.' }
                    ]
                }
            }
        }
    };

    let currentStudent = 'carlos';

    function switchStudent(studentId) {
        currentStudent = studentId;
        const data = students[studentId];

        function buildPills(clsArray) {
            let counts = { blocker: 0, watch: 0, clear: 0 };
            clsArray.forEach(c => { if(counts[c] !== undefined) counts[c]++; });
            let html = '';
            if (counts.blocker > 0) html += `<span class="summary-pill blocker"><span class="count">${counts.blocker}</span> Blocker${counts.blocker > 1 ? 's' : ''}</span>`;
            if (counts.watch > 0) html += `<span class="summary-pill watch"><span class="count">${counts.watch}</span> Watch${counts.watch !== 1 ? 'es' : ''}</span>`;
            if (counts.blocker === 0 && counts.watch === 0) html += `<span class="summary-pill clear">All Clear</span>`;
            return html;
        }

        document.getElementById('summary-ef').innerHTML = buildPills([data.engine.wmCls, data.engine.inhCls, data.engine.cfCls]);
        document.getElementById('text-ef-desc').innerText = data.engine.text;
        
        document.getElementById('badge-ef-wm').className = `badge ${data.engine.wmCls}`;
        document.getElementById('badge-ef-wm').innerText = data.engine.wm;
        document.getElementById('badge-ef-inh').className = `badge ${data.engine.inhCls}`;
        document.getElementById('badge-ef-inh').innerText = data.engine.inh;
        document.getElementById('badge-ef-cf').className = `badge ${data.engine.cfCls}`;
        document.getElementById('badge-ef-cf').innerText = data.engine.cf;

        // Pulse Animation for Blockers
        const engineCard = document.getElementById('card-engine');
        engineCard.classList.remove('pulse-blocker');
        if(data.engine.cls === 'blocker') { void engineCard.offsetWidth; engineCard.classList.add('pulse-blocker'); }

        document.getElementById('summary-fuel').innerHTML = buildPills([data.fuel.autCls, data.fuel.compCls, data.fuel.relCls]);
        document.getElementById('text-fuel-desc').innerText = data.fuel.text;
        
        document.getElementById('badge-fuel-aut').className = `badge ${data.fuel.autCls}`;
        document.getElementById('badge-fuel-aut').innerText = data.fuel.aut;
        document.getElementById('badge-fuel-comp').className = `badge ${data.fuel.compCls}`;
        document.getElementById('badge-fuel-comp').innerText = data.fuel.comp;
        document.getElementById('badge-fuel-rel').className = `badge ${data.fuel.relCls}`;
        document.getElementById('badge-fuel-rel').innerText = data.fuel.rel;

        const fuelCard = document.getElementById('card-fuel');
        fuelCard.classList.remove('pulse-blocker');
        if(data.fuel.cls === 'blocker') { void fuelCard.offsetWidth; fuelCard.classList.add('pulse-blocker'); }

        // Update all 12 durable skill badges
        const skillKeys = ['crit', 'cps', 'curio', 'init', 'resil', 'comm', 'adapt', 'collab', 'net', 'rel', 'emp', 'soc'];
        skillKeys.forEach(k => {
            const badge = document.getElementById(`badge-skill-${k}`);
            if (badge) {
                badge.className = `badge ${data.skills[k].cls}`;
                badge.innerText = data.skills[k].text;
            }
            const card = document.getElementById(`card-${k}`);
            if (card) card.classList.remove('selected');
        });

        document.getElementById('empty-state').style.display = 'flex';
        document.getElementById('ddx-output').style.display = 'none';
    }

    function selectSkill(skillId, cardElement) {
        document.querySelectorAll('.skill-row').forEach(c => c.classList.remove('selected'));
        cardElement.classList.add('selected');
        
        document.getElementById('empty-state').style.display = 'none';
        const ddxContainer = document.getElementById('ddx-output');
        ddxContainer.style.display = 'block';

        const profile = students[currentStudent].ddx[skillId];

        // Header Info
        document.getElementById('ddx-skill-title').innerText = profile.name;
        document.getElementById('ddx-ef-lens').innerText = "EF Lens: " + profile.efLens;
        const badge = document.getElementById('ddx-status-badge');
        badge.className = `badge ${profile.statusClass}`;
        badge.innerText = profile.statusText;

        // Populate Schema Fields
        document.getElementById('ddx-student-ui').innerText = profile.studentUi;

        // Recommendations
        const recsContainer = document.getElementById('ddx-recs-container');
        recsContainer.innerHTML = '';
        profile.recs.forEach(rec => {
            recsContainer.innerHTML += `
                <div class="rec-item">
                    <span class="rec-tag">${rec.tag}</span>
                    <span class="rec-title">${rec.title}</span>
                    <span style="display: block; margin-bottom: 0.25rem;">${rec.desc}</span>
                    <span class="rec-source">Sources: ${rec.source}</span>
                </div>
            `;
        });
    }

    // Initialize on load
    switchStudent('carlos');
</script>
</body>
</html>
